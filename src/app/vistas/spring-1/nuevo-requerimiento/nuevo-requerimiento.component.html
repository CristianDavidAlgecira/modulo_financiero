<div class="w-full mb-12 pb-8">

  <div class="w-full px-6 sm:px-24 md:px-36 mt-12 mb-12">

    <h1 class="text-primary1 !font-bold">
      Nuevo requerimiento
    </h1>

    <div class="flex justify-end p-4 space-x-4">

      <h6 class="text-primary1 !font-bold">
        Fecha creación {{ fechaActual }}
      </h6>

    </div>

    <div class="flex justify-end p-4 space-x-4">

      <h6 class="text-primary1 !font-bold">
        Días del requerimiento {{ diasRequerimiento }}
      </h6>

    </div>

    <div class="flex justify-between p-4 space-x-4 pb-8">

      <h6 class="text-primary1 !font-bold">
        Nota: Los campos con * son requeridos
      </h6>

    </div>


    <!-- Carta de contenidos -->
    <div class="card mt-2">

      <!-- Contenido 1 -->
      <div class="md:flex justify-center gap-4 px-4 pb-8">

        <div class="w-full">
          <label class="text-primary3 font-medium h-full text-xs">*Nombre del requerimiento</label>
          <select
            class="mt-1 shadow-sm rounded-md w-full p-2 border-2 border-secondary1 focus:outline-none focus:border-primary1 bg-transparent"
            [(ngModel)]="filtroNombreRequerimiento"
            #nombreRequerimiento="ngModel" required
            [ngClass]="{'border-error': nombreRequerimiento.invalid && (nombreRequerimiento.dirty || nombreRequerimiento.touched)}">
            <option value="" disabled selected hidden>Seleccione el nombre del requerimiento</option>
            <option *ngFor="let nombre of nombreRequerimientos" [value]="nombre">{{ nombre }}</option>
          </select>
          <div *ngIf="nombreRequerimiento.invalid && (nombreRequerimiento.dirty || nombreRequerimiento.touched)">
            <span class="text-red-500 text-xs">Este campo es obligatorio.</span>
          </div>
        </div>

        <div class="w-full">
          <label class="text-primary3 font-medium h-full text-xs">*Fecha Inicio</label>
          <input
            class="mt-1 shadow-sm rounded-md w-full p-2 border-2 border-secondary1 focus:outline-none focus:border-primary1 bg-transparent"
            type="date" [(ngModel)]="fechaInicio" #fechaInicioRef="ngModel" required
            [ngClass]="{'border-error': fechaInicioRef.invalid && (fechaInicioRef.dirty || fechaInicioRef.touched)}"
            (change)="calcularDias()">
          <div *ngIf="fechaInicioRef.invalid && (fechaInicioRef.dirty || fechaInicioRef.touched)">
            <span class="text-red-500 text-xs">Este campo es obligatorio.</span>
          </div>
        </div>

        <div class="w-full">
          <label class="text-primary3 font-medium h-full text-xs">*Periodo de entrega</label>
          <select
            class="mt-1 shadow-sm rounded-md w-full p-2 border-2 border-secondary1 focus:outline-none focus:border-primary1 bg-transparent"
            [(ngModel)]="filtroPeriodo" #periodoEntrega="ngModel" required
            [ngClass]="{'border-error': periodoEntrega.invalid && (periodoEntrega.dirty || periodoEntrega.touched)}">
            <option value="" disabled selected hidden>Seleccione el periodo de entrega</option>
            <option *ngFor="let periodo of periodos" [value]="periodo">{{ periodo }}</option>
          </select>
          <div *ngIf="periodoEntrega.invalid && (periodoEntrega.dirty || periodoEntrega.touched)">
            <span class="text-red-500 text-xs">Este campo es obligatorio.</span>
          </div>
        </div>

        <!-- Caja seleccionable 3 -->
        <div class="w-full">
          <label class="text-primary3 font-medium h-full text-xs">Estado del vigilado</label>
          <select
            class="mt-1 shadow-sm rounded-md w-full p-2 border-2 border-secondary1 focus:outline-none focus:border-primary1 bg-transparent"
            [(ngModel)]="filtroEstados">
            <option value="" disabled selected hidden>Seleccione el estado del vigilado</option>
            <option *ngFor="let estado of estados" [value]="estado">{{ estado }}</option>
          </select>
        </div>

      </div>

      <!-- Contenido 2 -->
      <div class="md:flex justify-center gap-4 px-4 pb-8">

        <!-- Input 5 -->
        <div class="w-full">
          <label class="text-primary3 font-medium h-full text-xs">Número acto administrativo</label>
          <input
            class="mt-1 shadow-sm rounded-md w-full p-2 border-2 border-secondary1 focus:outline-none focus:border-primary1 bg-transparent"
            type="number" placeholder="Digite el número de acto administrativo">
        </div>

        <!-- Input 6 -->
        <div class="w-full">
          <label class="text-primary3 font-medium h-full text-xs">Fecha publicación</label>
          <input
            class="mt-1 shadow-sm rounded-md w-full p-2 border-2 border-secondary1 focus:outline-none focus:border-primary1 bg-transparent"
            type="date">
        </div>

        <!-- Input 7 -->
        <div class="w-full">
          <label class="text-primary3 font-medium h-full text-xs">Año de vigencia</label>
          <input
            class="mt-1 shadow-sm rounded-md w-full p-2 border-2 border-secondary1 focus:outline-none focus:border-primary1 bg-transparent"
            type="number" placeholder="Digite el número de año">
        </div>

        <!-- Caja seleccionable 4 -->
        <div class="w-full">
          <label class="text-primary3 font-medium h-full text-xs">*Tipo de programación</label>
          <select
            class="mt-1 shadow-sm rounded-md w-full p-2 border-2 border-secondary1 focus:outline-none focus:border-primary1 bg-transparent"
            [(ngModel)]="filtroProgramaciones" (ngModelChange)="onProgramacionChange()" #tipoProgramacion="ngModel"
            required
            [ngClass]="{'border-error': tipoProgramacion.invalid && (tipoProgramacion.dirty || tipoProgramacion.touched)}">
            <option value="" disabled selected hidden>Seleccione el tipo de programación</option>
            <option *ngFor="let programacion of programaciones" [value]="programacion">{{ programacion }}</option>
          </select>
          <div *ngIf="tipoProgramacion.invalid && (tipoProgramacion.dirty || tipoProgramacion.touched)">
            <span class="text-red-500 text-xs">Este campo es obligatorio.</span>
          </div>
        </div>

      </div>

      <!-- Contenido 3 -->
      <div class="md:flex justify-center gap-4 px-4 pb-16">

        <!-- Carga de archivo pdf -->
        <div class="flex flex-col w-full h-full justify-center items-start pt-6l my-auto mb-2">
          <p class="text-primary3 font-semibold">
            Cargar acto administrativo
          </p>

          <app-file-upload class="mt-2 h-full" [dataClass]="dataClass" [maxFiles]="1" mimes=".pdf"
                           [error]="errorStates[1]" (uploadFile)="OnUploadButton($event)"/>
        </div>

      </div>


      <!-- Contenido desplegable -->
      <div class="md:flex justify-center gap-x-4 px-4 pb-4">

        <!-- Delegatura-->
        <div class="md:flex justify-center gap-4 px-4 pb-4" *ngIf="filtroProgramaciones === 'Delegatura'">

          <!-- Input 8 -->
          <div class="w-full">
            <label class="text-primary3 font-medium h-full text-xs">*Fecha Fin</label>
            <input
              class="mt-1 shadow-sm rounded-md w-full p-2 border-2 border-secondary1 focus:outline-none focus:border-primary1 bg-transparent"
              type="date" [(ngModel)]="fechaFin" #fechaFinRef="ngModel" required
              [ngClass]="{'border-error': (fechaFinRef.invalid && (fechaFinRef.dirty || fechaFinRef.touched)) || errorFechas}"
              (change)="calcularDias()" [disabled]="tipoVigiladoBloqueo">
            <div *ngIf="errorFechas && fechaFinRef.valid" class="text-red-500 text-xs">
              {{ errorFechas }}
            </div>
            <div *ngIf="errorFechas != '' && fechaFinRef.invalid && (fechaFinRef.dirty || fechaFinRef.touched)">
              <span class="text-red-500 text-xs">Este campo es obligatorio.</span>
            </div>
          </div>

          <!-- Caja seleccionable 5 -->
          <div class="w-full">
            <label class="text-primary3 font-medium h-full text-xs">*Delegatura</label>
            <select
              class="mt-1 shadow-sm rounded-md w-full p-2 border-2 border-secondary1 focus:outline-none focus:border-primary1 bg-transparent"
              [(ngModel)]="filtroDelegaturas" (change)="onDelegaturaChange()" #delegaturaRef="ngModel" required
              [ngClass]="{'border-error': delegaturaRef.invalid && (delegaturaRef.dirty || delegaturaRef.touched)}"
              [disabled]="isAdicionar">
              <option value="" disabled selected hidden>Seleccione la delegatura</option>
              <option *ngFor="let delegatura of delegaturas" [value]="delegatura">{{ delegatura }}</option>
            </select>
            <div *ngIf="delegaturaRef.invalid && (delegaturaRef.dirty || delegaturaRef.touched)">
              <span class="text-red-500 text-xs">Este campo es obligatorio.</span>
            </div>
          </div>

          <!-- Caja seleccionable 6 -->
          <div class="w-full">
            <label class="text-primary3 font-medium h-full text-xs">*Tipo de vigilado</label>
            <select
              class="mt-1 shadow-sm rounded-md w-full p-2 border-2 border-secondary1 focus:outline-none focus:border-primary1 bg-transparent"
              [(ngModel)]="filtroVigilados" #tipoVigiladosRef="ngModel" required
              [ngClass]="{'border-error': tipoVigiladosRef.invalid && (tipoVigiladosRef.dirty || tipoVigiladosRef.touched)}"
              [disabled]="tipoVigiladoBloqueo">
              <option value="" disabled selected hidden>Seleccione la delegatura</option>
              <option *ngFor="let vigilado of vigilados" [value]="vigilado">{{ vigilado }}</option>
            </select>
            <div *ngIf="tipoVigiladosRef.invalid && (tipoVigiladosRef.dirty || tipoVigiladosRef.touched)">
              <span class="text-red-500 text-xs">Este campo es obligatorio.</span>
            </div>
          </div>

          <!-- Botón Adicionar -->
          <div class="p-7">
            <app-primary-button type="button" (click)="btnAdicionar(1)" [disabled]="tipoVigiladoBloqueo">Adicionar
            </app-primary-button>
          </div>

        </div>


        <!-- Digito NIT-->
        <div class="md:flex justify-center gap-4 px-2 pb-4"
             *ngIf="filtroProgramaciones === 'Programación por dígito NIT'">

          <!-- Input 9 -->
          <div class="w-full">
            <label class="text-primary3 font-medium h-full text-xs">*Fecha Fin</label>
            <input
              class="mt-1 shadow-sm rounded-md w-full p-2 border-2 border-secondary1 focus:outline-none focus:border-primary1 bg-transparent"
              type="date" [(ngModel)]="fechaFin" #fechaFinRef2="ngModel" required
              [ngClass]="{'border-error': (fechaFinRef2.invalid && (fechaFinRef2.dirty || fechaFinRef2.touched)) || errorFechas}"
              (change)="calcularDias()" [disabled]="tipoVigiladoBloqueo">
            <div *ngIf="errorFechas && fechaFinRef2.valid" class="text-red-500 text-xs">
              {{ errorFechas }}
            </div>
            <div *ngIf="errorFechas != '' && fechaFinRef2.invalid && (fechaFinRef2.dirty || fechaFinRef2.touched)">
              <span class="text-red-500 text-xs">Este campo es obligatorio.</span>
            </div>
          </div>

          <!-- Caja seleccionable 7 -->
          <div class="w-full">
            <label class="text-primary3 font-medium h-full text-xs">*Programación por dígitos NIT</label>
            <select
              class="mt-1 shadow-sm rounded-md w-full p-2 border-2 border-secondary1 focus:outline-none focus:border-primary1 bg-transparent"
              [(ngModel)]="filtroDigitos" #digitosNIT="ngModel" required
              [ngClass]="{'border-error': digitosNIT.invalid && (digitosNIT.dirty || digitosNIT.touched)}">
              <option value="" disabled selected hidden>Seleccione la programación por dígitos NIT</option>
              <option *ngFor="let digito of digitos" [value]="digito">{{ digito }}</option>
            </select>
            <div *ngIf="digitosNIT.invalid && (digitosNIT.dirty || digitosNIT.touched)">
              <span class="text-red-500 text-xs">Este campo es obligatorio.</span>
            </div>
          </div>

          <!-- Input 10 -->
          <div class="w-full">
            <label class="text-primary3 font-medium h-full text-xs">*Dígitos Iniciales</label>
            <input
              class="mt-1 shadow-sm rounded-md w-full p-2 border-2 border-secondary1 focus:outline-none focus:border-primary1 bg-transparent"
              type="number" placeholder="Dígito(s) Inicial" [disabled]="!esOpcionSeleccionada()"
              (input)="validarDigito($event)" [(ngModel)]="digitoInicial" #digitoInicialRef="ngModel" required
              [ngClass]="{'border-error': digitoInicialRef.invalid && (digitoInicialRef.dirty || digitoInicialRef.touched)}">
            <div *ngIf="digitoInicialRef.invalid && (digitoInicialRef.dirty || digitoInicialRef.touched)">
              <span class="text-red-500 text-xs">Este campo es obligatorio.</span>
            </div>
          </div>

          <!-- Input 11 -->
          <div class="w-full">
            <label class="text-primary3 font-medium h-full text-xs">*Dígitos Finales</label>
            <input
              class="mt-1 shadow-sm rounded-md w-full p-2 border-2 border-secondary1 focus:outline-none focus:border-primary1 bg-transparent"
              type="number" placeholder="Dígito(s) Final" [disabled]="!esOpcionSeleccionada()"
              (input)="validarDigito($event)" [(ngModel)]="digitoFinal" #digitoFinalRef="ngModel" required
              [ngClass]="{'border-error': digitoFinalRef.invalid && (digitoFinalRef.dirty || digitoFinalRef.touched)}">
            <div *ngIf="digitoFinalRef.invalid && (digitoFinalRef.dirty || digitoFinalRef.touched)">
              <span class="text-red-500 text-xs">Este campo es obligatorio.</span>
            </div>
          </div>

          <!-- Botón Adicionar -->
          <div class="p-7">
            <app-primary-button type="button" (click)="btnAdicionar(2)">Adicionar</app-primary-button>
          </div>

        </div>

        <!-- Individual NIT-->
        <div class="md:flex justify-center gap-4 px-4 pb-4"
             *ngIf="filtroProgramaciones === 'Programación individual por NIT'">

          <!-- Input 12 -->
          <div class="w-full">
            <label class="text-primary3 font-medium h-full text-xs">*Fecha Fin</label>
            <input
              class="mt-1 shadow-sm rounded-md w-full p-2 border-2 border-secondary1 focus:outline-none focus:border-primary1 bg-transparent"
              type="date" [(ngModel)]="fechaFin" #fechaFinRef3="ngModel" required
              [ngClass]="{'border-error': (fechaFinRef3.invalid && (fechaFinRef3.dirty || fechaFinRef3.touched)) || errorFechas}"
              (change)="calcularDias()" [disabled]="tipoVigiladoBloqueo">
            <div *ngIf="errorFechas && fechaFinRef3.valid" class="text-red-500 text-xs">
              {{ errorFechas }}
            </div>
            <div *ngIf="errorFechas != '' && fechaFinRef3.invalid && (fechaFinRef3.dirty || fechaFinRef3.touched)">
              <span class="text-red-500 text-xs">Este campo es obligatorio.</span>
            </div>
          </div>

          <!-- Input 13 -->
          <div class="w-full">
            <label class="text-primary3 font-medium h-full text-xs">*Programación Individual por NIT</label>
            <input
              class="mt-1 shadow-sm rounded-md w-full p-2 border-2 border-secondary1 focus:outline-none focus:border-primary1 bg-transparent"
              type="number" placeholder="Digite el NIT de la empresa"
              [(ngModel)]="programacionNIT" #programacionNITRef="ngModel" required
              [ngClass]="{'border-error': programacionNITRef.invalid && (programacionNITRef.dirty || programacionNITRef.touched)}">
            <div *ngIf="programacionNITRef.invalid && (programacionNITRef.dirty || programacionNITRef.touched)">
              <span class="text-red-500 text-xs">Este campo es obligatorio.</span>
            </div>
          </div>

          <!-- Input 14 -->
          <div class="w-full">
            <label class="text-primary3 font-medium h-full text-xs">*Razón social</label>
            <input
              class="mt-1 shadow-sm rounded-md w-full p-2 border-2 border-secondary1 focus:outline-none focus:border-primary1 bg-transparent"
              type="text" placeholder="Digite el nombre de la razón social" [(ngModel)]="razonSocial"
              #razonSocialRef="ngModel" required
              [ngClass]="{'border-error': razonSocialRef.invalid && (razonSocialRef.dirty || razonSocialRef.touched)}">
            <div *ngIf="razonSocialRef.invalid && (razonSocialRef.dirty || razonSocialRef.touched)">
              <span class="text-red-500 text-xs">Este campo es obligatorio.</span>
            </div>
          </div>

        </div>

      </div>

      <div class="md:flex justify-center gap-x-4 px-4 pb-4" *ngIf="filtroProgramaciones && isAdicionar">

        <div class="w-full">

          <app-table-programaciones (editClicked)="openEditModal($event)" (deleteClicked)="deleteItem($event)"
                                    [headers]="headers" [data]="datosTable"></app-table-programaciones>

        </div>

      </div>

      <div class="flex justify-end p-4 space-x-4 pb-8">

        <!-- Botón Guardar -->
        <app-primary-button type="button">Guardar</app-primary-button>

        <!-- Botón Cancelar -->
        <button
          class="bg-secondary1 text-primary2 inline-flex items-center justify-center px-8 py-1
          hover:bg-primary2 hover:text-white font-medium rounded-full text-[16px] work-sans text-center"
          (click)="navigateToAdministracion()">
          Cancelar
        </button>

      </div>

    </div>

  </div>

</div>

<p-dialog
  header="Header"
  [(visible)]="showEditModal"
  [modal]="true"
  [style]="{ width: '40rem' }"
  [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }"
  [maximizable]="true">
  <ng-template pTemplate="header">
    <div class="inline-flex align-items-center justify-content-center gap-2">

      <span class="font-bold white-space-nowrap">
        Editar programación de id {{ datosEditar.id }}
      </span>
    </div>
  </ng-template>
  <span class="p-text-secondary block mb-5">Actualizar información.</span>
  <!-- DELEGATURA-->
  <div *ngIf="filtroProgramaciones === 'Delegatura'" class="w-full h-full px-2 py-4">
    <!-- fecha fin -->
    <div class="flex align-items-center gap-3 mb-3">
      <label for="fechaFin" class="text-primary3 font-semibold w-6rem h-full flex justify-center items-center">Fecha
        Fin</label>
      <input id="fechaFin"
             class="shadow-sm rounded-md w-full p-2 border-2 border-secondary1 focus:outline-none focus:border-primary1 bg-transparent"
             type="date" [(ngModel)]="fechaFin" #fechaFinRef="ngModel" required
             [ngClass]="{'border-error': fechaFinRef.invalid && (fechaFinRef.dirty || fechaFinRef.touched)}"
             (change)="calcularDias()">
      <div *ngIf="fechaFinRef.invalid && (fechaFinRef.dirty || fechaFinRef.touched)">
        <span class="text-red-500 text-xs">Este campo es obligatorio.</span>
      </div>
    </div>
    <div *ngIf="filtroDelegaturas == 'Todas'" class="flex align-items-center gap-3 mb-3">
      <label for="vigilado" class="text-primary3 font-semibold w-6rem h-full flex justify-center items-center">Tipo de
        vigilado</label>
      <select id="vigilado"
              class="shadow-sm rounded-md w-full p-2 border-2 border-secondary1 focus:outline-none focus:border-primary1 bg-transparent flex justify-center items-center"
              [(ngModel)]="filtroVigilados" #tipoVigiladosRef="ngModel" required
              [ngClass]="{'border-error': tipoVigiladosRef.invalid && (tipoVigiladosRef.dirty || tipoVigiladosRef.touched)}">
        <option value="" disabled selected hidden>Seleccione el tipo de vigilado</option>
        <option *ngFor="let vigilado of vigilados" [value]="vigilado">{{ vigilado }}</option>
      </select>
      <div *ngIf="tipoVigiladosRef.invalid && (tipoVigiladosRef.dirty || tipoVigiladosRef.touched)">
        <span class="text-red-500 text-xs">Este campo es obligatorio.</span>
      </div>
    </div>
  </div>
    <ng-template pTemplate="footer" class="gap-x-2">
      <button class="bg-secondary1 text-primary2 inline-flex items-center justify-center px-8 py-1
          hover:bg-primary2 hover:text-white font-medium rounded-full text-[16px] work-sans text-center"
              (click)="showEditModal = false">
        Cancelar
      </button>
      <!-- Botón Guardar -->
      <app-primary-button type="button" (click)="editDataTable()">Guardar</app-primary-button>

    </ng-template>
</p-dialog>

